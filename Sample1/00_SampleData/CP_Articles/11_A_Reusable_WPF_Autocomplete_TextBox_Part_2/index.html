<!DOCTYPE html>
<html style="height: 100%;">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	<title>A Reusable WPF Autocomplete TextBox (Part 2) - CodeProject</title> 
	


	

<meta name="Description" content="This article is about a control that can be used to auto-omplete folders that have been typed into a textbox. It shows just how versatile binding and theming in WPF really is.; Author: Dirkster99; Updated: 24 Nov 2011; Section: Windows Presentation Foundation; Chapter: Platforms, Frameworks &amp; Libraries; Updated: 24 Nov 2011">
<meta name="Keywords" content=".NET, Dev, WPF, Intermediate, C#4.0, VS2010,Windows Presentation Foundation,Platforms, Frameworks &amp; Libraries,Free source code, tutorials">
<meta name="Author" content="Dirkster99">
<meta name="Rating" content="General">
<meta name="Robots" content="index, follow, NOODP">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="http://ajax.googleapis.com/"> 
<link rel="canonical" href="http://www.codeproject.com/Articles/273978/A-Reusable-WPF-Autocomplete-TextBox-Part">


<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Android" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=22">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - iOS" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=25">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - C++" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=2">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - C#" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=3">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Web" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=23">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="http://www.codeproject.com/webservices/LoungeRSS.aspx">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="http://www.codeproject.com/info/OpenSearch.xml">

	<base target="_top">
	<link rel="icon" href="favicon.ico" type="image/ico">
<link rel="shortcut icon" href="favicon.ico" type="image/ico">
<link rel="apple-touch-icon" href="http://www.codeproject.com/images/FavIcon-Apple.png" type="image/png">


	








<link rel="stylesheet" type="text/css" href="index.css" media="all">
</head>
<body style="position: relative; min-height: 100%; top: 0px;" class="firefox firefox23">

<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="t.gif"></a>





<div class="page-background">

	
	

	

	<table id="ctl00_Bn" style="width: 100%; height: 135px;" class="banner fluid" cellpadding="0" cellspacing="0">
	<tbody><tr valign="bottom">
		<td class="blank-background" style="height: 31px;">&nbsp;</td>
		<td class="blank-background" rowspan="3" style="width: 250px; height: 135px;"><a href="http://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="logo250x135.gif" alt="Home" style="height: 135px; width: 250px; border-width: 0px;"></a></td>
		<td class="blank-background align-right" style="width: 728px; height: 31px;"></td>
		<td class="blank-background" style="height: 31px;">&nbsp;</td>
	</tr>
	<tr valign="middle">
		<td class="theme1-background" style="height: 94px;">&nbsp;</td>
		<td class="theme1-background ad"></td>
		<td class="theme1-background" style="height: 94px;">&nbsp;</td>
	</tr>
	<tr valign="top">
		<td style="height: 14px;"></td>
		<td style="height: 14px;" class="blank-background"></td>
		<td style="height: 14px;"></td>
	</tr>
</tbody></table>


	<a href="#Main"><img alt="Click here to Skip to main content" class="access-link" src="t.gif"></a>

	
	
	

	<div id="A" class="container-content-wrap fluid print"> 

	<div itemscope="" itemtype="http://schema.org/Article" class="container-content"> 

		<div class="clearfix">
			<div class="float-left container-breadcrumb">
				<div><a href="http://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> » <a href="http://www.codeproject.com/Chapters/8/Platforms-Frameworks-Libraries.aspx">Platforms, Frameworks &amp; Libraries</a> » <a href="http://www.codeproject.com/KB/WPF/"><span itemprop="articleSection">Windows Presentation Foundation</span></a> » <a href="http://www.codeproject.com/KB/WPF/#Controls">Controls</a></div>
			</div>

			<div class="align-left float-right padded-top" style="width">
				
			</div>

			<div class="float-right article-nav">
				
				
			</div>

			<div class="align-right float-left">
				
			</div>
		</div>

		<table class="extended container-article-parts" cellpadding="0" cellspacing="0">
        <tbody><tr valign="top">
		<td width="117px">

			

		</td>
		<td>
			
			<div id="AT" class="container-article  fluid tight"> 
				<div class="article">

					<form name="aspnetForm" method="post" action="http://www.codeproject.com/Articles/273978/A-Reusable-WPF-Autocomplete-TextBox-Part?display=Print" id="aspnetForm" style="margin: 0px; padding: 0px;">
<div>
<input name="__VIEWSTATE" id="__VIEWSTATE" value="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" type="hidden">
</div>

<div>

	<input name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69" type="hidden">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        
					        <h1 id="ctl00_ArticleTitle" itemprop="name">A Reusable WPF Autocomplete TextBox (Part 2)</h1> 
					    </div>

                        <div style="height: 34px;">
					        
					        <div class="entry float-left">
                                
                                <div class="float-left">

						            <span class="author"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=7799028" rel="author"><span itemprop="author" itemscope="" itemtype="http://schema.org/Person"><span itemprop="name">Dirkster99</span></span></a></span>, 
						            <span class="date" itemprop="dateModified" content="2011-11-24 18:33:00">
							            25 Nov 2011</span>
			
                                    <a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a><div id="ctl00_CurRat" class="tooltip anchorLink" style="cursor: pointer; margin-top: 5px;">
				
							            

<table class="small-text" itemprop="aggregateRating" itemscope="" itemtype="http://schema.org/AggregateRating" cellpadding="0" cellspacing="0"> 
<tbody><tr>
	
	<td class="nowrap">

		
			<meta itemprop="bestRating" content="5"> 
			<meta itemprop="worstRating" content="1">
		

		<span id="ctl00_ArticleRating_VI">
		<div class="nowrap rating-stars-large" style="height: 21px; width: 119px; position: relative;">
	<div class="clipped align-left float-left" style="height: 19px; width: 115px;">
		<img src="stars-fill-lg.png" style="border-width: 0px;">
	</div><div class="clipped" style="height: 19px; width: 4px; position: relative;">
		<img src="stars-empty-lg.png" style="border-width: 0px; position: absolute; top: 0px; right: 0px;">
	</div>
</div>
		</span>

		
	</td>
	
	<td id="ctl00_ArticleRating_VR" class="nowrap">
		&nbsp;
		<span id="ctl00_ArticleRating_VotesR">&nbsp;<span itemprop="ratingValue" class="rating">4.82</span> (<span itemprop="ratingCount" class="count">4</span> votes)</span>
		
	</td>

</tr>

</tbody></table>


							            <div id="ctl00_RB" class="speech-bubble-container-up">
								            <div class="speech-bubble-up" style="width: 150px ! important;">
									                        
<div>
<table class="feature" title="Voting Distribution. Recent data only" cellpadding="0" cellspacing="0" height="20px" width="100%"><tbody><tr class="chart-row"><td class="chart-column"><span title="0 votes">1</span></td>
<td class="chart-column"><span title="0 votes">2</span></td>
<td class="chart-column"><span title="0 votes">3</span></td>
<td class="chart-column"><div><img src="pollcol.gif" alt="2 votes, 50.0%" title="2 votes, 50.0%" border="0px" height="20px" width="20pxpx"></div><span title="2 votes">4</span></td>
<td class="chart-column"><div><img src="pollcol.gif" alt="2 votes, 50.0%" title="2 votes, 50.0%" border="0px" height="20px" width="20pxpx"></div><span title="2 votes">5</span></td>
</tr></tbody></table><div class="small-text align-center">4.82/5 - 4 votes</div><div class="small-text align-center subdue">μ 4.82, σ<sub>a</sub> 1.01 [<a href="http://www.codeproject.com/KB/FAQs/RatingReputationFAQ.aspx#noisefilter">?</a>]</div>
</div>
								            </div>
								            <div class="speech-bubble-pointer-up">
									            <div class="speech-bubble-pointer-up-inner"></div>
								            </div>
							            </div>
						            </div>
                                </div>
					        </div>

                            
						    
						    	

						    	
                            <div class="float-right" style="margin: 4px 20px 0px 0px;">
						        
                            </div>                    
						    	
                        </div>

   					    
                        <div id="ctl00_description" class="summary">This article is about a control that can be used to auto-omplete folders that have been typed into a textbox. It shows just how versatile binding and theming in WPF really is.</div>			

                    </div>
                    
					
					

					

					
					
					

						
					

					

						
						<div id="contentdiv" class="text" itemprop="articleBody">
						



<ul class="download">

<li><a href="autocomplete_textbox_src.zip">Download source code - 79 KB</a></li>


<li><a href="autocomplete_textbox_bin.zip">Download demo - 53.8 KB</a></li>

</ul>


<div class="Caption">An overview of the Autocomplete TextBox using different the WhistlerBlue, ExpressionDark, or no theme</div>


<div class="Caption">ExpressionDark:</div>


<p><img alt="Sample Image" src="expressiondark.png" height="694" width="372"></p>


<div class="Caption">WhistlerBlue:</div>


<p><img alt="Sample Image" src="whistlerblue.png" height="702" width="370"></p>


<div class="Caption">No Theme:</div>


<p><img alt="Sample Image" src="noapplicationtheme.png" height="721" width="387"></p>


<h2>Introduction</h2>


<p>This article is based on the excellent article <a href="http://www.codeproject.com/KB/WPF/autocomplete_textbox.aspx">"A Reusable WPF Autocomplete TextBox"</a> by Aviad P. 
I wrote it because I wanted to show just how flexible binding and theming in WPF really is.</p>


<p>Therefore, I:</p>


<ol>

<li>replaced the XML binding with bindings to run-time objects,</li>


<li>changed the data source of the ViewModel to <code>System.IO.Directory</code>... to auto-complete over sub directories,</li>


<li>and added two themes (ExpressionDark, WhistlerBlue) to the mix.</li>

</ol>


<p>The resulting control can be used to auto complete folders that have been typed into a textbox. Uniform Naming Convention (UNC) is supported. 
The ViewModel persists a list of recently typed <em>\\server\share</em> addresses into an XML file that is stored in the Application Data directory (see <em>Window1.xaml.cs</em> for details).</p>


<h2>Background</h2>


<p>I have been looking for a skinable auto complete folder browser (folder picker) control that allows the selection of a folder just like the address bar in the Windows Explorer does. 
All sample implementations that I found seemed to be based on comboboxes. These have the disadvantage of implementing the standard combobox behaviour, 
which is rather strange when the user picks one entry and the popup-list disappears (the text in the textbox is selected).</p>


<p>I wanted a control that supports the following workflow:</p>


<ol>

<li>The user types a path into the textbox portion of the control</li>


<ol>

<li>The control suggests a list of sub-entries (if any)</li>


<li>The user selects an entry</li>


<li>The control adds the selected entry to the typed path in the textbox and adds a directory delimter (<em>\</em>)</li>

</ol>

</ol>


<p>Note that the last three steps are repeated until the final path is in the textbox (user can hit the ESC key to make the pop-list disappear). This way, a user is no longer being 
bothered typing much of an address at all. The user can use the mouse or the keyboard to browse the file system structure via pop-up and the path displayed in the textbox.</p>


<h2>Using the code</h2>


<h3>StyleCop</h3>


<p>I use StyleCop in my projects to make the code readable in a uniform way. So, you can either download and install StyleCop, or edit/remove the corresponding 
entries in each <em>.csproj</em> file, should you get an error when compiling the project:</p>


<pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">Import</span> <span class="code-attribute">Project</span><span class="code-keyword">="</span><span class="code-keyword">$(ProgramFiles)\MSBuild\StyleCop\v4.5\StyleCop.Targets"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span></pre>


<h3>Project structure</h3>


<p>The project has the following structure:</p>


<table cellpading="5" border="0" cellspacing="5">

<tbody>

<tr>

<td align="left" valign="top">
<p><img src="solutionexplorer.png" height="420" width="222"></p>
</td>


<td align="left" valign="top">
<p>The <code>Test</code> project contains a test application (to be replaced by your own) and 
the <code>Aviad.WPF.Controls</code> project contains the DLL project. You should be able to hit F5, 
and give this a go, if the <code>Test</code> project is your start-up project.</p>


<p>The <em>ViewModel.cs</em> file is where the background queries for the sub-directory entries are implemented (more details further below). 
I moved <em>ViewModel.cs</em> and <em>MyDataTemplateSelector.cs</em> into the DLL project, 
because I wanted the control to be available and usable without having to think about these details.</p>


<p>The <code>ShareCollection</code> class in the <em>Shares.cs</em> file is used in the <code>ViewModel</code> class whenever the 
user types a UNC path containing only a name of a file server without shares (eg.: <em>\\MyFileServer\</em>). Note that I added the <em>Themes</em> folder 
in the Test project. This is where the themes for <code>ExpressionDark</code> and <code>WhistlerBlue</code> live. While the <em>Themes</em> folder in the ACTB project 
contains only the <code>Gerneric</code> theme (which is used if WPF cannot find a style in any other resource).</p>


<p>The <code>AutoCompleteTextBox</code> control is themed with the style defined in <em>Generic.xaml</em>. This style is applied, if the system cannot find corresponding 
styles in any other theme (if any). The <em>ExpressionDark.xaml</em> and <em>WhistlerBlue.xaml</em> files contain <code>AutoCompleteTextBox</code> styles for the corresponding themes. 
Therefore, the style in <em>Generic.xaml</em> is completely ignored if either theme is activated in <em>App.xaml</em>.</p>

</td>

</tr>

</tbody>

</table>


<p>Changing the theme is possible via an entry in the <em>App.xaml</em> file. Enter <em>WhistlerBlue.xaml</em> or <em>ExpressionDark.xaml</em> in the highlighted location below (I know this 
can be done at run-time via radio control (or whatever), but I chose to leave it like this because I wanted to leave the sample as simple as possible).</p>


<pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">Application</span> <span class="code-attribute">x:Class</span><span class="code-keyword">="</span><span class="code-keyword">Test.App"</span>
    <span class="code-attribute">xmlns</span><span class="code-keyword">="</span><span class="code-keyword">http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
    <span class="code-attribute">xmlns:x</span><span class="code-keyword">="</span><span class="code-keyword">http://schemas.microsoft.com/winfx/2006/xaml"</span>
    <span class="code-attribute">xmlns:actb</span><span class="code-keyword">="</span><span class="code-keyword">clr-namespace:Aviad.WPF.Controls;assembly=Aviad.WPF.Controls"</span>

    <span class="code-attribute">xmlns:local</span><span class="code-keyword">="</span><span class="code-keyword">clr-namespace:Test"</span>
    <span class="code-attribute">StartupUri</span><span class="code-keyword">="</span><span class="code-keyword">Window1.xaml"</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">Application.Resources</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">ResourceDictionary</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">ResourceDictionary.MergedDictionaries</span><span class="code-keyword">&gt;</span>

        <span class="code-keyword">&lt;</span><span class="code-leadattribute">ResourceDictionary</span> <span class="code-attribute">Source</span><span class="code-keyword">="</span><span class="code-keyword">Themes/<strong>ExpressionDark.xaml</strong>"</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">ResourceDictionary</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">ResourceDictionary.MergedDictionaries</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">ResourceDictionary</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">Application.Resources</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">Application</span><span class="code-keyword">&gt;</span></pre>


<p>Here are the settings that I used for the screenshots in Table 1:</p>


<ul>

<li>ExpressionDark:</li>


<ul>

<li>Set <em>Themes/ExpressionDark.xaml</em> in the <code>Application.Resources</code> tag in <em>App.xaml</em>.</li>

</ul>


<li>WhistlerBlue:</li>


<ul>

<li>Set <em>Themes/WhistlerBlue.xaml</em> in the <code>Application.Resources</code> tag in <em>App.xaml</em>.</li>

</ul>


<li>No Theme:</li>


<ul>

<li>Remove the <em>Themes/*.xaml</em> entry from the <code>Application.Resources</code> tag in <em>App.xaml</em>.</li>


<li>Remove or re-define themed <code>StaticResource</code> entries in <em>Window1.xaml</em>:</li>


<ol>

<li><code>Background="{StaticResource MyWindowBackgroundBrush}"</code> in Window tag</li>


<li><code>Foreground="{StaticResource TextBrush}"</code> in <code>TextBlock</code> tag</li>

</ol>

</ul>

</ul>


<h2>Points of interest</h2>


<p>The <code>QueryList</code> method in the ViewModel class is the main function executed whenever the control 
attempts to query the system for additional entries. Additional entries can be queried from the file system via the 
<code>System.IO.Directory.GetDirectories</code> function or (for UNC) via the <code>ShareCollection</code> class defined in <em>Shares.cs</em>.</p>


<p>Both process, typing in the textbox, and queries for sub-directories, are disconnected from each other, 
because each query for sub-directories is executed in a background thread. This is all done without having to use another thread class (!), but instead, by implementing 
the <code>PriorityBinding</code> construct in the <em>Window1.xam</em> file. Actually, this was already implemented in the original version of the control,
but I thought I should point this out so we all understand why this is working the way it works...</p>


<p>I also realized that I could not be bothered to re-type the same <em>\\server\shared folder\</em> address over and over and over again... 
Therefore, we have data handling for a custom list of <em>\\server\shared folder\</em> entries in the <code>ViewModel</code> class. 
The <code>ViewModel</code> class is XML serializable. It is persisted and initialized from disk whenever the window in <em>Window1.xaml.cs</em> 
is closed or constructed. Please review the <code>List&lt;string&gt; SuggestEntries</code> property in the <code>ViewModel</code> class 
and the corresponding methods in <em>Window1.xaml.cs</em> to fully understand this addition.</p>


<p>I noticed a small problem in an earlier version of the control. The selection color of the drop-down list was sometimes off 
(it was Blue). This was due to the fact that I had no ListBoxItem style within the ListBox style 
of the <code>AutocompleteTextBox.Popup</code>. The key to styling this correctly is the <code>ItemContainerStyle</code> property 
in the <code>&lt;Style TargetType="{x:Type aviad:AutoCompleteTextBox}"&gt;</code> section in the <em>ExpressionDark.xaml</em> and <em>WhistlerBlue.xaml</em> files.</p>


<p>I would have liked to make the <code>WaitMessage</code> disappear, while keeping the architecture with the <code>PriorityBinding</code> in <em>Window1.xaml</em>. 
But I was unable to find an easy way of doing this. Please let me know if you see a simple solution for removing the <code>WaitMessage</code> without re-implementing the whole control.</p>


<p>Please give me your feedback if there are any other "obvious" improvements that I might have missed.</p>


<h2>History</h2>


<ul>

<li>25<sup>th</sup> October, 2011: Initial post.</li>


<li>22<sup>th</sup> November, 2011:</li>


<ul>

<li>Bug fix on asynchronous query and correct usage of <code>CollectionViewSource</code> in <em>Window1.xaml</em>.</li>


<li>Added classes in <em>Shares.cs</em> to query folder shares of file servers via UNC notation.</li>


<li>Added styling for <code>ItemContainerStyle</code> in AutoCompleteTextbox 
styles and improved styles in each theme (events, such as mouseover, focus, etc., result in fade in or fade out of some GUI elements).</li>

</ul>

</ul>


						</div>
						

						<div class="float-right" style="margin: 20px 0px 0px 10px; border: 1px solid rgb(204, 204, 204);">
						
						</div>
                        
                        
						
						
						<div id="LicenseTerms"></div>
						

                        
						
				        <div style="margin-bottom: 40px; width: 385px;">
					        
				        </div> 
    			        


						
						
						

<br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top: 8px;">
							
						</div>

						
						
						
					

				    
					</form>

				</div>

				
				

					
					
					
					
				

			</div>
			
		</td>
		<td width="170px">
			
		</td>
		</tr></tbody></table>

		
		

		<div class="extended tiny-text">
			
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div>
</div>


<div style="display: none;" id="dm_AdTable">
	
</div>






<div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="translate-32.png" height="20" width="20"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">Original text</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">Contribute a better translation</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: rgb(204, 204, 204); background-color: rgb(204, 204, 204); height: 1px; border: medium none;"><div class="activity-root"></div></div></div><div style="display: none;" class="status-message"></div></div>



<iframe src="index_1.html" style="visibility: visible; -moz-box-sizing: content-box; width: 878px; height: 275px; display: none;" class="goog-te-menu-frame skiptranslate" frameborder="0"></iframe>


</body></html>
