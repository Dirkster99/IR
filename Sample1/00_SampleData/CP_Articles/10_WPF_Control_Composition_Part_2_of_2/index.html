<!DOCTYPE html>
<html style="height: 100%;">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	<title>WPF Control Composition (Part 2 of 2) - CodeProject</title> 
	


	

<meta name="Description" content="Theming an existing user control adds flexibilty at the application side without changing the original implementation. This article gives an example by theming a user control that was previously not fully themeable.; Author: Dirkster99; Updated: 21 Mar 2012; Section: Windows Presentation Foundation; Chapter: Platforms, Frameworks &amp; Libraries; Updated: 21 Mar 2012">
<meta name="Keywords" content="C#, Windows, .NET, Architect, Dev, WPF, Design, Intermediate, C#4.0,Windows Presentation Foundation,Platforms, Frameworks &amp; Libraries,Free source code, tutorials">
<meta name="Author" content="Dirkster99">
<meta name="Rating" content="General">
<meta name="Robots" content="index, follow, NOODP">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="http://ajax.googleapis.com/"> 
<link rel="canonical" href="http://www.codeproject.com/Articles/332541/WPFControlCompositionPart-of">


<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Android" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=22">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - iOS" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=25">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - C++" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=2">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - C#" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=3">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Web" href="http://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=23">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="http://www.codeproject.com/webservices/LoungeRSS.aspx">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="http://www.codeproject.com/info/OpenSearch.xml">

	<base target="_top">
	<link rel="icon" href="favicon.ico" type="image/ico">
<link rel="shortcut icon" href="favicon.ico" type="image/ico">
<link rel="apple-touch-icon" href="http://www.codeproject.com/images/FavIcon-Apple.png" type="image/png">


	








<link rel="stylesheet" type="text/css" href="index.css" media="all">
</head>
<body style="position: relative; min-height: 100%; top: 0px;" class="firefox firefox23">

<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="t.gif"></a>





<div class="page-background">

	
	

	

	<table id="ctl00_Bn" style="width: 100%; height: 135px;" class="banner fluid" cellpadding="0" cellspacing="0">
	<tbody><tr valign="bottom">
		<td class="blank-background" style="height: 31px;">&nbsp;</td>
		<td class="blank-background" rowspan="3" style="width: 250px; height: 135px;"><a href="http://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="logo250x135.gif" alt="Home" style="height: 135px; width: 250px; border-width: 0px;"></a></td>
		<td class="blank-background align-right" style="width: 728px; height: 31px;"></td>
		<td class="blank-background" style="height: 31px;">&nbsp;</td>
	</tr>
	<tr valign="middle">
		<td class="theme1-background" style="height: 94px;">&nbsp;</td>
		<td class="theme1-background ad"></td>
		<td class="theme1-background" style="height: 94px;">&nbsp;</td>
	</tr>
	<tr valign="top">
		<td style="height: 14px;"></td>
		<td style="height: 14px;" class="blank-background"></td>
		<td style="height: 14px;"></td>
	</tr>
</tbody></table>


	<a href="#Main"><img alt="Click here to Skip to main content" class="access-link" src="t.gif"></a>

	
	
	

	<div id="A" class="container-content-wrap fluid print"> 

	<div itemscope="" itemtype="http://schema.org/Article" class="container-content"> 

		<div class="clearfix">
			<div class="float-left container-breadcrumb">
				<div><a href="http://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> » <a href="http://www.codeproject.com/Chapters/8/Platforms-Frameworks-Libraries.aspx">Platforms, Frameworks &amp; Libraries</a> » <a href="http://www.codeproject.com/KB/WPF/"><span itemprop="articleSection">Windows Presentation Foundation</span></a> » <a href="http://www.codeproject.com/KB/WPF/#Controls">Controls</a></div>
			</div>

			<div class="align-left float-right padded-top" style="width">
				
			</div>

			<div class="float-right article-nav">
				
				
			</div>

			<div class="align-right float-left">
				
			</div>
		</div>

		<table class="extended container-article-parts" cellpadding="0" cellspacing="0">
        <tbody><tr valign="top">
		<td width="117px">

			

		</td>
		<td>
			
			<div id="AT" class="container-article  fluid tight"> 
				<div class="article">

					<form name="aspnetForm" method="post" action="http://www.codeproject.com/Articles/332541/WPFControlCompositionPart-of?display=Print" id="aspnetForm" style="margin: 0px; padding: 0px;">
<div>
<input name="__VIEWSTATE" id="__VIEWSTATE" value="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" type="hidden">
</div>

<div>

	<input name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69" type="hidden">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        
					        <h1 id="ctl00_ArticleTitle" itemprop="name">WPF Control Composition (Part 2 of 2)</h1> 
					    </div>

                        <div style="height: 34px;">
					        
					        <div class="entry float-left">
                                
                                <div class="float-left">

						            <span class="author"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=7799028" rel="author"><span itemprop="author" itemscope="" itemtype="http://schema.org/Person"><span itemprop="name">Dirkster99</span></span></a></span>, 
						            <span class="date" itemprop="dateModified" content="2012-03-21 11:33:00">
							            21 Mar 2012</span>
			
                                    <a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a><div id="ctl00_CurRat" class="tooltip anchorLink" style="cursor: pointer; margin-top: 5px;">
				
							            

<table class="small-text" itemprop="aggregateRating" itemscope="" itemtype="http://schema.org/AggregateRating" cellpadding="0" cellspacing="0"> 
<tbody><tr>
	
	<td class="nowrap">

		
			<meta itemprop="bestRating" content="5"> 
			<meta itemprop="worstRating" content="1">
		

		<span id="ctl00_ArticleRating_VI">
		<div class="nowrap rating-stars-large" style="height: 21px; width: 119px; position: relative;">
	<div class="clipped align-left float-left" style="height: 19px; width: 115px;">
		<img src="stars-fill-lg.png" style="border-width: 0px;">
	</div><div class="clipped" style="height: 19px; width: 4px; position: relative;">
		<img src="stars-empty-lg.png" style="border-width: 0px; position: absolute; top: 0px; right: 0px;">
	</div>
</div>
		</span>

		
	</td>
	
	<td id="ctl00_ArticleRating_VR" class="nowrap">
		&nbsp;
		<span id="ctl00_ArticleRating_VotesR">&nbsp;<span itemprop="ratingValue" class="rating">4.80</span> (<span itemprop="ratingCount" class="count">11</span> votes)</span>
		
	</td>

</tr>

</tbody></table>


							            <div id="ctl00_RB" class="speech-bubble-container-up">
								            <div class="speech-bubble-up" style="width: 150px ! important;">
									                        
<div>
<table class="feature" title="Voting Distribution. Recent data only" cellpadding="0" cellspacing="0" height="20px" width="100%"><tbody><tr class="chart-row"><td class="chart-column"><span title="0 votes">1</span></td>
<td class="chart-column"><span title="0 votes">2</span></td>
<td class="chart-column"><span title="0 votes">3</span></td>
<td class="chart-column"><div><img src="pollcol.gif" alt="3 votes, 27.3%" title="3 votes, 27.3%" border="0px" height="7px" width="20pxpx"></div><span title="3 votes">4</span></td>
<td class="chart-column"><div><img src="pollcol.gif" alt="8 votes, 72.7%" title="8 votes, 72.7%" border="0px" height="20px" width="20pxpx"></div><span title="8 votes">5</span></td>
</tr></tbody></table><div class="small-text align-center">4.80/5 - 11 votes</div><div class="small-text align-center subdue">μ 4.80, σ<sub>a</sub> 0.85 [<a href="http://www.codeproject.com/KB/FAQs/RatingReputationFAQ.aspx#noisefilter">?</a>]</div>
</div>
								            </div>
								            <div class="speech-bubble-pointer-up">
									            <div class="speech-bubble-pointer-up-inner"></div>
								            </div>
							            </div>
						            </div>
                                </div>
					        </div>

                            
						    
						    	

						    	
                            <div class="float-right" style="margin: 4px 20px 0px 0px;">
						        
                            </div>                    
						    	
                        </div>

   					    
                        <div id="ctl00_description" class="summary">Theming an existing user control adds flexibilty at the application side without changing the original implementation. This article gives an example by theming a user control that was previously not fully themeable.</div>			

                    </div>
                    
					
					

					

					
					
					

						
					

					

						
						<div id="contentdiv" class="text" itemprop="articleBody">
						



<ul class="download">
<li><a href="c__users_sean.office_desktop_holding_ground_simplecontrols_version2.zip">Download control - 89.8 KB</a></li>
</ul>




<h2>Introduction  </h2>

<p>The theming technique in WPF is an effective way of coding once and enhancing the user<br>experience through individual user interfaces (<a title="A sampe article on theming" href="http://www.codeproject.com/Articles/273978/A-Reusable-WPF-Autocomplete-TextBox-Part-2" target="_top">A Reusable WPF Autocomplete TextBox (Part 2)</a>). This part of the two article series concentrates on theming a watermark textbox control discussed in a <a title="Part 1 of this article series" href="http://www.codeproject.com/Articles/332539/WPFControlCompositionPart1of2" target="_top">previous part</a>. We are going to create a look-less custom watermark textbox control to be more specific.</p><div align="center"><img alt="332541/Screenshot.png" src="screenshot.png" height="630" width="500"></div><br>Please review the <a title="Part 1 of this article series" href="http://www.codeproject.com/Articles/332539/WPFControlCompositionPart1of2" target="_top">previous article</a> if you have any questions beyond theming.<br><h2>Compiling the Code </h2><h2>StyleCop</h2><p>I use StyleCop in my projects to make the code readable in a uniform way. So, if you should get an error when compiling the project, you can either download and install StyleCop, or edit/remove the corresponding entries in each .csproj file:</p><pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">Import</span> <span class="code-attribute">Project</span><span class="code-keyword">="</span><span class="code-keyword">$(ProgramFiles)\MSBuild\StyleCop\v4.7\StyleCop.Targets"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span> </pre><h2>Theming the Demo Application </h2>Normally, I am using a seperate DLL project to add theming to any other application.<br>But to make things simple, I have simply added:<br><ul><li>A Themes folder with 3 themes</li><li>A MainCommands command class to bind and execute a viewTheme command</li><li>A Menubar to let the user selet a theme </li><li>A TypeOfTheme enumeration and some code based on it to manage, select and change to a particular theme when requested</li></ul>The core theming function in the main TestWindow is the <code>ChangeThemeCommand_Executed</code> <br>function. It accepts the name of the theme to change to as string parameter, which is supplied<br>from the MenuBar item calls. The theme name is mapped to an enumeration which in turn is mapped to a static const string array containing the resource address of the main theme XAML file.<br><br>I know this is all very hands on and not what you would program in a production scenario.<br>But the demo application is really just a necessity to get us going for what we came here.<br>We came here to learn more about programming look-less controls. So, lets discuss this next.<br><h2>Creating a Look-Less Custom Control</h2>Theming a WPF control contained in a DLL project requires 4 things:<br><ul><li>A Themes folder with a Generic.xaml file</li><li>A ThemeInfo entry in the AssemblyInfo file</li><li>Removing the XAML from the User Control</li><li>Making helper classes public </li></ul>These items are discussed next.<br><h2>Generic.xaml</h2>Making a WPF control fully skinnable requires a Themes folder with a Generic.xaml file in it. The Generic.xaml file should contain a default declaration of the custom control. That default declaration is applied by the WPF framework whenever there is no alternative declaration.<br><br>In our case, the Generic theme in the test application does not contain a definition for the <code>TextBoxWithWatermark</code> control. And therefore, the defintion in the <code>Themes/Generic.xaml</code> file in the DLL project is applied when the user selects the Generic theme in the demo application. The other two themes contain a seperate definition for the <code>TextBoxWithWatermark</code> control, which enables us to color the watermark in theme specific colors.<br><br>Explaining all the content in the <code>Generic.xaml</code> file and the theming files in the demo application would be way too much for this article. But you should note the following:<br><br>The two color statements at the beginning of the <code>Generic.xaml</code> file in the Themes folder of the DLL project:<br><br><pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">SolidColorBrush</span> <span class="code-attribute">x:Key</span><span class="code-keyword">="</span><span class="code-keyword">brushWatermarkForeground"</span> <span class="code-attribute">Color</span><span class="code-keyword">="</span><span class="code-keyword">#AA000033"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span> 
<span class="code-keyword">&lt;</span><span class="code-leadattribute">SolidColorBrush</span> <span class="code-attribute">x:Key</span><span class="code-keyword">="</span><span class="code-keyword">brushWatermarkBackground"</span> <span class="code-attribute">Color</span><span class="code-keyword">="</span><span class="code-keyword">Transparent"</span> <span class="code-keyword">/</span><span class="code-keyword">&gt;</span> </pre>... define the background and foreground color of the watermark shown in the textbox.<br>These color resources are consumed in the XAML further below.<br><br><pre><span class="code-keyword">&lt;</span><span class="code-leadattribute">Style</span> <span class="code-attribute">TargetType</span><span class="code-keyword">="</span><span class="code-keyword">{x:Type local:TextBoxWithWatermark}"</span><span class="code-keyword">&gt;</span>
    &lt;Setter Property=<span class="code-string">"</span><span class="code-string">SnapsToDevicePixels"</span> Value=<span class="code-string">"</span><span class="code-string">True"</span>/&gt;
    &lt;Setter Property=<span class="code-string">"</span><span class="code-string">Template"</span>&gt;
      &lt;Setter.Value&gt;
        &lt;ControlTemplate TargetType=<span class="code-string">"</span><span class="code-string">{x:Type local:TextBoxWithWatermark}"</span>&gt;
          &lt;ControlTemplate.Resources&gt;
            &lt;BooleanToVisibilityConverter x:Key=<span class="code-string">"</span><span class="code-string">BooleanToVisibilityConverter"</span> /&gt;
            &lt;local:WatermarkHelper x:Key=<span class="code-string">"</span><span class="code-string">WatermarkHelper"</span> /&gt;
          <span class="code-keyword">&lt;/</span><span class="code-leadattribute">ControlTemplate.Resources</span><span class="code-keyword">&gt;</span>
          <span class="code-keyword">&lt;</span><span class="code-leadattribute">Grid</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;</span><span class="code-leadattribute">Grid.RowDefinitions</span><span class="code-keyword">&gt;</span></pre><p>The <code>Style</code> tag at the root tells WPF that we are going to define a style for each and every<br><code>TextBoxWithWatermark</code> control that does not come with an alternative style. An alternative style can either be defined in:</p><ul><li>A theme specific XAML file (see <code>DarkExpresssion/SimpleStyles/SimpleControls.xaml</code>)  or </li><li>through a control specific style resource assigned to the <code>Style</code> property<br><br>(not covered here, see <a href="http://msdn.microsoft.com/en-us/library/ms752294.aspx" target="_top">How to: Define and Reference a Resource</a>).</li></ul><p>The most basic style application includes a <code>Setter </code>property tag in which the <code>Property </code>attribute selects the properties' name, and the <code>Value </code>attribute the actual value that we want to define for this particular style.<br><br>The <code>Template </code>setter is a little more elaborate. It can be used to define a ControlTemplate for our custom control. The control template contains pretty much the same code as the original user control from the first part of this article. Compare the contents in the <code>TextBoxWithWatermark.xaml</code> file from part 1 with the <code>SimpleControls/Themes/Generic.xaml</code> file in part 2 and you will notice that I moved the <code>UserControl.Resources</code> section into the <code>ControlTemplate.Resources</code> and kept the layout in the Grid  further below.</p><h2>ThemeInfo </h2><p>Defining a default look and feel for a control in <code>Themes/Generic.xaml</code> file is only half the price because we also have to tell WPF to look there if a style is not defined. We do this by stating the <code>ThemeInfo </code>attribute in the <code>SimpleControls/Properties/AssemblyInfo.cs</code> file:</p><pre lang="cs">[assembly: ThemeInfo(
    ResourceDictionaryLocation.None, <span class="code-comment">//</span><span class="code-comment"> where theme specific resource dictionaries are located
</span>  <span class="code-comment">//</span><span class="code-comment"> (used if a resource is not found in the page, or application resource dictionaries)
</span>    ResourceDictionaryLocation.SourceAssembly <span class="code-comment">//</span><span class="code-comment"> where the generic resource dictionary is located
</span>  <span class="code-comment">//</span><span class="code-comment"> (used if a resource is not found in the page, 
</span>  <span class="code-comment">//</span><span class="code-comment"> app, or any theme specific resource dictionaries)
</span>)] </pre><h2>Removing XAML portion from a User Control</h2><p>A custom look-less control does not define its own GUI. Instead the GUI is either defined in the <code>Generic.xaml</code> file of the source assembly or in the applications theming. Therefore, I have removed the  <code>TextBoxWithWatermark.<strong>xaml</strong></code> portion from the <code>TextBoxWithWatermark.xaml.<strong>cs</strong> </code> user control of part 1 and created effectively a new code behind file in <code>TextBoxWithWatermark.cs</code>.<br><br>Comparing <code>TextBoxWithWatermark</code><code>.xaml.<strong>cs</strong></code>  from part 1 with<code> TextBoxWithWatermark.cs</code> from part 2 reveals that I only added a static constructor and removed the standard constructor (since <code>this.InitializeComponent();</code> is no longer used in a custom control.</p><pre lang="cs"><span class="code-keyword">static</span> TextBoxWithWatermark()
{ 
  DefaultStyleKeyProperty.OverrideMetadata(<span class="code-keyword">typeof</span>(&lt;b&gt;TextBoxWithWatermark<span class="code-keyword">&lt;/</span><span class="code-leadattribute">b</span><span class="code-keyword">&gt;</span>),
      new FrameworkPropertyMetadata(typeof(<span class="code-keyword">&lt;</span><span class="code-leadattribute">b</span><span class="code-keyword">&gt;</span>TextBoxWithWatermark<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">b</span><span class="code-keyword">&gt;</span>)));
} </pre><p>The <code>DefaultStyleKeyProperty</code> property tells WPF to find the default style<br>for the <code>TextBoxWithWatermark</code> control class in the <code>Themes/Generic.xaml</code> file.<br>This is done with a static constructor because it applies to each and every  TextBoxWithWatermark control object that does not get its style through an alternative route as discussed above.<br><br>It is worthwhile to point out that you can use the <code>OnApplyTemplate</code> method to initialize a look-less control whenever a new theme is applied to it. This was not necessary here so I did note implement that method.</p><h2>Making Helper Classes Public </h2><p>This part of creating a custom look-less control is not strictly necessary for every custom control but I included it here because it might raises a few eye browse otherwise.<br><br>The 'special' thing about the watermarked textbox is that it uses a converter (<a href="http://www.codeproject.com/Articles/298950/Using-ValueConverter-and-MultiValueConverter-in-WP" target="_top">Using ValueConverter and MultiValueConverter in WPF)</a> to decide whether the watermark should be shown or not.<br><br>Comparing <code>WatermarkHelper.cs</code> converter from part 1 with that of part 2 reveals that I changed the visibility of the class from internal to public. This change was necessary<br>because the ControlTemplates in the ExpressionDark and WhistlerBlue themes would otherwise not have worked and I did not see a reason to strictly hide this in the custom control implementation. <br><br>Making the converter public and part of the ControlTemplate adds flexibility to this implementation because it enables everyone to implement there own converter and showing the watermark based on there own logic without having to change the original implementation in the DLL project.</p><h2>Conclusions </h2>This series of two articles has taught me that control composition in a user control can save me a lot of work if it is done at the right level. The simplicity of binding dependency properties is so nice I could almost write a code generation program for it (and maybe I will some day).<br><br>I hope you enjoyed this series. Please vote for this article and give me your feedback if you find something wrong or otherwise noteworthy.<br><h2>History </h2><ul><li>20-February 2012 Initial creation  </li><li>16-March 2012 Small bug fix in source (Dependency Properties in WebHyperlink control are specified correctly) &nbsp;</li></ul>


						</div>
						

						<div class="float-right" style="margin: 20px 0px 0px 10px; border: 1px solid rgb(204, 204, 204);">
						
						</div>
                        
                        
						
						
						<div id="LicenseTerms"></div>
						

                        
						
				        <div style="margin-bottom: 40px; width: 385px;">
					        
				        </div> 
    			        


						
						
						

<br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top: 8px;">
							
						</div>

						
						
						
					

				    
					</form>

				</div>

				
				

					
					
					
					
				

			</div>
			
		</td>
		<td width="170px">
			
		</td>
		</tr></tbody></table>

		
		

		<div class="extended tiny-text">
			
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div>
</div>


<div style="display: none;" id="dm_AdTable">
	
</div>






<div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="translate-32.png" height="20" width="20"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">Original text</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">Contribute a better translation</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: rgb(204, 204, 204); background-color: rgb(204, 204, 204); height: 1px; border: medium none;"><div class="activity-root"></div></div></div><div style="display: none;" class="status-message"></div></div>



<iframe src="index_1.html" style="visibility: visible; -moz-box-sizing: content-box; width: 878px; height: 275px; display: none;" class="goog-te-menu-frame skiptranslate" frameborder="0"></iframe>


</body></html>
